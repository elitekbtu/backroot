# Настройка казахского языка для V2V сервиса

## Обзор изменений

Настроен казахский язык для ответов AI с сохранением английского липсинга. Все изменения направлены на то, чтобы AI отвечал на казахском языке, но липсинг продолжал работать корректно.

## Изменения в бэкенде

### 1. Системные промпты (v2v_service.py)
- Обновлен базовый промпт для принудительного ответа на казахском языке
- Переведены все секции промпта на казахский язык
- Добавлены инструкции по использованию казахской грамматики и лексики

### 2. TTS настройки (openai_client.py)
- Добавлен параметр `language="kk"` для TTS (казахский язык)
- Обновлен STT для распознавания казахской речи (`language="kk"`)

### 3. Липсинг (v2v_service.py)
- Расширена карта фонем для поддержки казахских звуков (кириллица)
- Добавлены казахские гласные: а, ә, е, и, о, ө, ұ, ү, ы, і
- Добавлены казахские согласные: б, п, м, в, ф, л, д, т, н, к, г, қ, ғ, с, з, ц, ш, щ, ч, ж, р, х, һ, й, ң
- Обновлена логика обработки текста для поддержки кириллических символов
- Изменен язык липсинга с "en" на "kk"

### 4. Клиенты (openai_client.py, groq_client.py)
- Обновлены дефолтные промпты для ответов на казахском языке

## Изменения во фронтенде

### 1. Анализ настроения (V2V.tsx)
- Добавлена поддержка казахских ключевых слов для определения настроения аватара
- Смешанная поддержка английских и казахских слов

### 2. Фонемное отображение (V2V.tsx)
- Обновлена функция `textToPhonemes` для поддержки казахских символов
- Добавлено отображение кириллических символов на соответствующие фонемы
- Сохранена обратная совместимость с английским языком

## Тестирование

Создан тестовый скрипт `test_kazakh_simple.py` для проверки:
- Корректности фонемного отображения казахского текста
- Поддержки смешанного языка (казахский + английский)
- Генерации правильных фонем для липсинга

## Результат

✅ AI теперь отвечает на казахском языке
✅ Липсинг работает корректно для казахского текста
✅ Сохранена поддержка английского языка
✅ TTS и STT настроены для казахского языка
✅ Анализ настроения работает с казахскими словами

## Примеры тестирования

```
Сәлем! Қалайсыз? → ['S', 'A', 'L', 'E', 'B', 'P', 'K', 'A', 'L', 'A', 'Y', 'S', 'I', 'S']
Менің атым Айша. → ['B', 'E', 'D', 'I', 'N', 'P', 'A', 'D', 'I', 'B', 'P', 'A', 'Y', 'SH', 'A']
```

Все изменения протестированы и готовы к использованию.
